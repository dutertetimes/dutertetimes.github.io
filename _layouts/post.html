---
layout: default
---

{% include post_left_sidebar.html %}

<section class="post_column_main">

    <h1>{{ page.title | markdownify }}</h1>
    <div class="meta">
        {% if site.debug %}
            {% if page.image.source %}
        <img src="{{ site.image_source }}/post/{{ page.image.source }}" />
            {% else %}
        <img src="{{ site.url }}/images/offline/twitter_summary_card_01.png" />
            {% endif %}
        {% endif %}

        <p class="date">Date: {% if page.date %} {{ page.date | date: site.data.format.date_only }} {% else %} Undated {% endif %}</p>

        {% if site.debug %}
        {% if page.excerpt %}<p class="excerpt">{{ page.excerpt }}</p>{% endif %}
        <p class="category">Categories:&nbsp;{{ page.categories | join: ", "}}</p>
        <p class="tag">Tags:&nbsp;{{ page.tags | join: ", " }}</p>
        {% endif %}

        {% if page.sources.size and page.sources.size > 0 and page.sources[0].link %}
        <div class="info_sources">
            <p>Sources:
                {% for source in page.sources %}
                    {% if source.link %}
                <span><a href="{{ source.link }}" target="_blank">{{ source.label }}</a></span>{% unless forloop.last %},{% endunless %}
                    {% else %}
                <span>{{ source.label }}</span>{% unless forloop.last %},{% endunless %}
                    {% endif %}
                {% endfor %}
            </p>
        </div>
        {% endif %}
    </div>

    {% if page.related and page.related.size > 0 %}
    <div class="related_posts">
        {% for link in page.related %}
            {% for post in site.posts %}
                {% if post.permalink == link %}
            <p><a href="{{ link }}">{{ post.title }}</a>&nbsp;&ndash;&nbsp;<span class="date">{{ post.date | date: site.data.format.date_only_long_month }}</p></li>
                {% endif %}
            {% endfor %}
        {% endfor %}
    </div>
    {% endif %}

    {% include post_operations.html %}

    {% if page.image.source != nil %}
        {% assign has_video = false %}
        {% assign video_source="" %}
        {% assign video_attribution="" %}
        {% if page.video.source != nil and page.video.layout == "top" %}
            {% assign has_video = true %}
            {% assign video_source=page.video.source %}
            {% assign video_attribution=page.video.attribution %}
            {% include youtube_video.html video_id=video_source attribution=video_attribution %}
        {% else %}
            {% if page.videos[0].source != nil and page.videos[0].layout == "top" %}
                {% assign has_video = true %}
                {% assign video_source=page.videos[0].source %}
                {% assign video_attribution=page.videos[0].attribution %}
            {% endif %}
        {% endif %}
        
        {% if has_video == false %}
            {% unless page.image.layout == "none" %}
            <div class="image_container">
                {% if page.image.layout == "auto_width" %}
                <div class="image_auto_width">
                {% else %}
                <div>
                {% endif %}
                    <img width="100%" height="auto" src="{{ site.image_source }}/post/{{ page.image.source }}" />
                    <p class="attribution">Image by {{ page.image.attribution }}&nbsp;</p>
                </div>
            </div>
            {% endunless %}
        {% endif %}
    {% else %}
        {% assign video_source="" %}
        {% assign video_attribution="" %}
        {% if page.video.source != nil and page.video.layout == "top" %}
            {% assign video_source=page.video.source %}
            {% assign video_attribution=page.video.attribution %}
            {% include youtube_video.html video_id=video_source attribution=video_attribution %}
        {% else %}
            {% if page.videos[0].source != nil and page.videos[0].layout == "top" %}
                {% assign video_source=page.videos[0].source %}
                {% assign video_attribution=page.videos[0].attribution %}
                {% include youtube_video.html video_id=video_source attribution=video_attribution %}
            {% endif %}
        {% endif %}
    {% endif %}

    {{ content }}

    {% assign video_source="" %}
    {% assign video_attribution="" %}
    {% if page.videos[1].source != nil and page.videos[1].layout == "bottom" %}
        {% assign video_source=page.videos[1].source %}
        {% assign video_attribution=page.videos[1].attribution %}
        {% include youtube_video.html video_id=video_source attribution=video_attribution %}
    {% endif %}

    {% include post_bottom.html %}

</section>

{% include post_right_sidebar.html %}
